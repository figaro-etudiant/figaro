!function(a,b,c){var d=function(){};d.prototype.inject=function(a,b){for(var c=0,d=b.length;d>c;c++)for(var e in b[c].prototype)"function"==typeof b[c].prototype[e]&&(a.prototype[e]=b[c].prototype[e])};var e=function(){};e.prototype.s=function(a){return c.querySelectorAll(a)},e.prototype.id=function(a){return c.getElementById(a)},e.prototype.removeClass=function(a,b){for(var c=new RegExp("\\b"+b+"\\b","g"),d=0,e=a.length;e>d&&a[d];d++)a[d].className=a[d].className.replace(c,"").split(/\s+/).join(" ")},e.prototype.setClass=function(a,b){for(var c=new RegExp("\\b"+b+"\\b","g"),d=0,e=a.length;e>d&&a[d];d++)a[d].className=a[d].className.replace(c,"").split(/\s+/).join(" "),a[d].className=a[d].className+" "+b},e.prototype.fillOrRemove=function(a,b,c){a?c.apply(this,[b,a]):b.parentNode.removeChild(b)},e.prototype.createMessagingFrame=function(a,d){var e=c.createElement("iframe");a.url&&(e.setAttribute("src",this.config.papiUrl+"/oauth/authorize?client_id="+this.clientId+"&redirect_uri="+encodeURIComponent(this.config.widgetsUrl+a.url+"?"+a.QueryParameter.map(function(a){return a.name+"="+a.value}).join("&"))+"&response_type=token&scope=api&state="+this.getState()+"&language="+this.language),e.setAttribute("seamless",""),e.setAttribute("frameborder",0),e.setAttribute("id","messageFrame"),e.setAttribute("name","messageFrame"),e.setAttribute("width","580px"),e.setAttribute("allowtransparency",!0),e.setAttribute("scrolling","no"),e.style.visibility="hidden",e.style.position="absolute",e=c.getElementsByTagName("body")[0].appendChild(e),b.addEventListener("message",function(a){var b;return a.origin!==this.config.widgetsUrl&&a.origin!==this.config.papiUrl?d(new Error('Unable to process message from "'+a.origin+'"'),null):(b=JSON.parse(a.data),d.bind(this)(null,b),!0)}.bind(this)))},e.prototype.enable=function(a){var b="string"==typeof a?this.id(a):a;this.removeClass([b],"enabled"),this.removeClass([b],"disabled"),b.className=b.className+" enabled"},e.prototype.disable=function(a){var b="string"==typeof a?this.id(a):a;this.removeClass([b],"enabled"),this.removeClass([b],"disabled"),b.className=b.className+" disabled"};var f=function(){};f.prototype.prepare=function(a,c){function d(a,b){return e&&(a+="?"+e.map(function(a){return a.name+"="+a.value}).join("&")),a}var e,f,g;return a.widgetEndPoint?g=this.config.papiUrl+"/api/widgets/"+a.widgetEndPoint:a.endPoint?g=a.endPoint:c(new Error("request targeted endPoint is missing")),a.QueryParameter&&(e=a.QueryParameter),a.BodyParameter&&(f=a.BodyParameter),b.XDomainRequest?((a.OAuthRequired||void 0===a.OAuthRequired)&&(void 0===e?e=[{name:"type",value:this.getParam("token_type",!0)},{name:"token",value:this.getParam("access_token",!0)}]:(e.push({name:"type",value:this.getParam("token_type",!0)}),e.push({name:"token",value:this.getParam("access_token",!0)}))),a.csrfToken&&(void 0===e?e=[{name:"X-CSRF-Token",value:a.csrfToken}]:e.push({name:"X-CSRF-Token",value:a.csrfToken})),req=new XDomainRequest,g=d(g,e),req.open(a.method,g,void 0===a.async?!0:a.async),a.headers&&a.headers.map(function(b){return a.params[b.name]=b.value,b}),req.onerror=function(){c.apply(this,[new Error("your request ended with a fail"),null])}.bind(this),req.onload=function(){req.responseText?c.apply(this,[null,JSON.parse(req.responseText)]):c.apply(this,[null,{}])}.bind(this)):(req=new XMLHttpRequest,g=d(g,e),req.open(a.method,g,void 0===a.async?!0:a.async),req.setRequestHeader("Content-Type","application/json"),req.setRequestHeader("Accept","application/json"),(a.OAuthRequired||void 0===a.OAuthRequired)&&req.setRequestHeader("Authorization",this.getParam("token_type",!0)+" "+this.getParam("access_token",!0)),a.headers&&a.headers.map(function(a){return req.setRequestHeader(a.name,a.value),a}),req.onreadystatechange=function(){if(4===req.readyState)switch(req.status){case 200:c.apply(this,[null,JSON.parse(req.responseText)]);break;case 204:c.apply(this,[null,{}]);break;default:c.apply(this,[{reason:req.responseText},null])}}.bind(this)),req},f.prototype.get=function(a,b){var c,d;a.method="GET",a.QueryParameter&&(d=a.QueryParameter),"access_denied"===this.getParam("error",!0)?this.closeIn():(c=this.prepare(a,b),c.send())},f.prototype.post=function(a,b){a.method="POST",a.csrfNeeded?this.get({OAuthRequired:!1,endPoint:this.config.papiUrl+"/api/portal/utils/csrf"},function(c,d){return c?b(c,null):(a.csrfToken=d.csrfToken,a.headers?a.headers.push({name:"X-CSRF-Token",value:a.csrfToken}):a.headers=[{name:"X-CSRF-Token",value:a.csrfToken}],a.params||(a.params={}),req=this.prepare(a,b),void req.send(JSON.stringify(a.params)))}):(req=this.prepare(a,b),req.send(JSON.stringify(a.params)))};var g=function(){this.detect=function(){isPreviousSiblingNodeAWidgetInstance=function(a){for(var b=1,c=a.previousSibling;c;){if(c.nodeType===b)return"iframe"===c.nodeName.toLowerCase()&&/^vw-\d+$/.test(c.getAttribute("id"))?c:!1;c=c.previousSibling}return!1};for(var a=this.s("script[type^=vd]"),d=this.config.widgetsUrl,e={language:"en",format:"normal"},f=0;f<a.length;f++){var g=a[f],h=isPreviousSiblingNodeAWidgetInstance(g),i=g.type.replace("vd/","");h&&g.parentNode.removeChild(h),g.setAttribute("data-vd-id",f);var j=i.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()});for(var k in e){var l=g.attributes["data-vd-"+k];l&&""!==l||g.setAttribute("data-vd-"+k,e[k])}for(var m,n="",o="?",p=0;p<g.attributes.length;p++){var q=g.attributes[p];-1!==q.name.lastIndexOf("data-vd-")&&("data-vd-client-id"===q.name?n=n+o+"client_id="+q.value:(m=q.name.replace("data-vd-","").split("-").map(function(a,b){var c;return c=0===b?a:a.substring(0,1).toUpperCase()+a.substring(1)}).join(""),n=n+o+m+"="+q.value),o="&")}n=n+"&widget_type="+j;var r=c.createElement("iframe");r.setAttribute("src",d+"/s/"+i+"/widget_"+g.getAttribute("data-vd-language")+".html"+n),r.setAttribute("seamless",""),r.setAttribute("frameborder",0),r.setAttribute("id","vw-"+f),r.setAttribute("name","vw-"+f),r.setAttribute("width","580px"),r.setAttribute("allowtransparency",!0),r.setAttribute("scrolling","no"),r.style.visibility="hidden",r.style.position="absolute",r=g.parentNode.insertBefore(r,g)}b.addEventListener("message",this.messageListener.bind(this),!1)},this.messageListener=function(a){var b;if(a.origin!==this.config.widgetsUrl)return!1;switch(b=JSON.parse(a.data),b.type){case"resize":var c=this.id("vw-"+b.id);c.setAttribute("width",b.data.x+"px"),c.setAttribute("height",b.data.y+"px"),c.style.visibility="visible",c.style.position="relative"}return!0}};d.prototype.inject(g,[e,f]);var h=new g;h.config=a;var i=function(){"complete"===c.readyState&&(h.detect(),c.removeEventListener("readystatechange",i))};"complete"===c.readyState?h.detect():c.addEventListener("readystatechange",i)}({papiUrl:"https://partners.viadeo.com",widgetsUrl:"https://widgets-partners.viadeo.com",signinUrl:"https://secure.viadeo.com"},window,document);